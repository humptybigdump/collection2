N = 3
S = {
     0: {"A"},
     1: {"B","C", "D"},
     2: {"E","F"},
     3: {"G"},
}
A = {
    (0, "A"): {"B","C", "D"},
    (1, "B"): {"E"},
    (1, "C"): {"E","F"},
    (1, "D"): {"E","F"},
    (2, "E"): {"G"},
    (2, "F"): {"G"},
}
z = {
    (0, "A","B"): "B",
    (0, "A","C"): "C",
    (0, "A","D"): "D",
    (1, "B","E"): "E",
    (1, "C","E"): "E",
    (1, "C","F"): "F",
    (1, "D","E"): "E",
    (1, "D","F"): "F",
    (2, "E","G"): "G",
    (2, "F","G"): "G"
}
r = {
    (0, "A","B"): -7,
    (0, "A","C"): -8,
    (0, "A","D"): -5,
    (1, "B","E"): -12,
    (1, "C","E"): -8,
    (1, "C","F"): -9,
    (1, "D","E"): -7,
    (1, "D","F"): -13,
    (2, "E","G"): -9,
    (2, "F","G"): -6
}
V = {
    (3, "G"): 0
}
s_0 = "A"

a_opt = {}
for n in range(N - 1,-1,-1):
    for s in S[n]:
        V[n, s] = -9999
        a_opt[n, s] = ""
        for a in A[n, s]:
            v_test = r[n, s, a] + V[n + 1, z[n, s, a]]
            if v_test > V[n, s]:
                V[n, s] = v_test
                a_opt[n, s] = a
        print("V_", n, s, ": ", V[n, s], ", a*: ", a_opt[n, s])

a_opt_s_0 = {}
s = s_0
for n in range(0, N):
    a_opt_s_0[n, s] = a_opt[n, s]
    s = z[n, s, a_opt[n, s]]
print(a_opt_s_0)